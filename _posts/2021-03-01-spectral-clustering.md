---
title: ìŠ¤í™íŠ¸ëŸ´ í´ëŸ¬ìŠ¤í„°ë§ ì´í•´í•˜ê¸°
date: 2021-03-01 11:33:00 +09:00
categories:
  - Posts
  - Data
tags:
  - ml
  - graph
  - unsupervised-learning
math: true
toc: true
comments: true
image: /assets/img/posts/2021-03-01-spectral-clustering_1.png
---
> ìŠ¤í™íŠ¸ëŸ´ í´ëŸ¬ìŠ¤í„°ë§ì„ ì–´ë–»ê²Œ í•˜ëŠ”ì§€ì— ëŒ€í•œ ê¸€ì´ë©° ì¨ë³´ê¸°ë³´ë‹¤ëŠ” ì´í•´í•˜ê¸°ë¥¼ ëª©ì ìœ¼ë¡œ ì ì—ˆìŠµë‹ˆë‹¤.
{: .prompt-info }


## ë­˜ê¹Œ?

ìŠ¤í™íŠ¸ëŸ´ í´ëŸ¬ìŠ¤í„°ë§ì€ í´ëŸ¬ìŠ¤í„°ë§, ì¦‰ êµ°ì§‘í™” ê¸°ë²•ì˜ ì¼ì¢…ì…ë‹ˆë‹¤. í´ëŸ¬ìŠ¤í„°ë§ì˜ ê¸°ë³¸ ëª©ì ì€ ì£¼ì–´ì§„ ë¼ë²¨ ì—†ëŠ” ë°ì´í„°ì— ëŒ€í•´ ë¹„ìŠ·í•œ ê²ƒë¼ë¦¬ êµ°ì§‘ìœ¼ë¡œ ë¬¶ì–´ì£¼ëŠ” ê²ƒì´ì£ . ë¹„ìŠ·í•œ ê²ƒë“¤ì€ ê°™ì€ êµ°ì§‘ì— ì†í•˜ê³  ë‹¤ë¥¸ ê²ƒë“¤ì€ ë‹¤ë¥¸ êµ°ì§‘ì— ì†í•˜ë„ë¡ í•©ë‹ˆë‹¤. 

ê·¸ ì¤‘ì—ì„œë„ ìŠ¤í™íŠ¸ëŸ´ í´ëŸ¬ìŠ¤í„°ë§ì€ **ê·¸ë˜í”„ ê¸°ë°˜** í´ëŸ¬ìŠ¤í„°ë§ì…ë‹ˆë‹¤. ê·¸ë˜í”„ ê¸°ë°˜ì´ë¼ëŠ” ê²ƒì€ **ë°ì´í„°ë“¤ ê°„ì˜ ìƒëŒ€ì ì¸ ê´€ê³„ë‚˜ ì—°ê²°**ì„ ê°€ì¥ ì¤‘ìš”í•œ ì •ë³´ë¡œ ì´ìš©í•˜ê² ë‹¤ëŠ” ëœ»ì…ë‹ˆë‹¤. 

ì´ê²ƒì´ ë°”ë¡œ ê°€ì¥ ì˜ ì•Œë ¤ì§„ í´ëŸ¬ìŠ¤í„°ë§ ê¸°ë²• ì¤‘ í•˜ë‚˜ì¸ K-í‰ê·  í´ëŸ¬ìŠ¤í„°ë§ê³¼ì˜ í° ì°¨ì´ì ì¸ë°ìš”, K-í‰ê·  í´ëŸ¬ìŠ¤í„°ë§ì€ ìœ í´ë¦¬ë””ì–¸ ê³µê°„ ìœ„ì˜ ë°ì´í„°ì˜ ê°’ë“¤ ìì²´ì˜ ê±°ë¦¬(ìœ ì‚¬ë„)ë¥¼ ê¸°ë°˜ìœ¼ë¡œ, êµ°ì§‘ì˜ ì¤‘ì‹¬ì„ ì •í•˜ê³  ê·¸ ì¤‘ì‹¬ì— ê°€ê¹ê²Œ ë°ì´í„°ë“¤ì„ ë°°ì •í•´ê°€ëŠ” ë°©ì‹ìœ¼ë¡œ êµ°ì§‘ì„ ì°¾ì•„ëƒ…ë‹ˆë‹¤. ë°˜ë©´ ê·¸ë˜í”„ ê¸°ë°˜ìœ¼ë¡œ ì ‘ê·¼í•  ê²½ìš° ë°ì´í„°ë“¤ì˜ ì ˆëŒ€ì  ìœ„ì¹˜ê°€ ì¤‘ìš”í•œ ê²ƒì´ ì•„ë‹ˆë¼ ê·¸ë“¤ì´ ì—°ê²°ë˜ì–´ ìˆëŠ”ì§€(ì—°ê²°ë˜ì–´ ìˆë‹¤ë©´ ì–¼ë§ˆë‚˜ ê°€ê¹Œì´ ê°•í•˜ê²Œ ì—°ê²°ë˜ì–´ ìˆëŠ”ì§€)ë¥¼ ë³´ê³  ê°™ì€ êµ°ì§‘ì¸ì§€ ì•„ë‹Œì§€ë¥¼ íŒë‹¨í•˜ê²Œ ë©ë‹ˆë‹¤.

ê° ì ‘ê·¼ì—ëŠ” ì¥ë‹¨ì´ ìˆì„ ê²ƒì´ê³ , ë‹¹ì—°íˆ êµ°ì§‘í™”í•˜ê³ ì í•˜ëŠ” ë°ì´í„°ê°€ ì–´ë–»ê²Œ ìƒê²¼ëŠ”ì§€ì— ë”°ë¼ ì„ íƒì´ ë‹¬ë¼ì ¸ì•¼ í•©ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´ ì € ë§¨ ìœ„ ê·¸ë¦¼ ê°™ì€ ë°ì´í„°ë¼ë©´, K-í‰ê· ë³´ë‹¤ëŠ” ìŠ¤í™íŠ¸ëŸ´ í´ëŸ¬ìŠ¤í„°ë§ì´ ìš°ë¦¬ê°€ ì›í•˜ëŠ” êµ°ì§‘ì„ ì°¾ëŠ” ë° ì í•©í•©ë‹ˆë‹¤.

![](/assets/img/posts/2021-03-01-spectral-clustering_2.png)

## ì–´ë–»ê²Œ í• ê¹Œ?

ìŠ¤í™íŠ¸ëŸ´ í´ëŸ¬ìŠ¤í„°ë§ì„ í•˜ëŠ” ë°©ë²•ì€ í¬ê²Œ ë‹¤ìŒ ë‘ ê°€ì§€ ë‹¨ê³„ë¡œ ì•„ì£¼ì•„ì£¼ ê°„ë‹¨í•˜ê²Œ ë‚˜ëˆ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

1. **ìœ ì‚¬ë„ ê·¸ë˜í”„ë¥¼ ë§Œë“ ë‹¤.** 
2. **ê·¸ë˜í”„ë¥¼ ìª¼ê°œì„œ ì—¬ëŸ¬ ê°œì˜ í´ëŸ¬ìŠ¤í„°ë¥¼ ì–»ëŠ”ë‹¤.**

### ìœ ì‚¬ë„ ê·¸ë˜í”„ ë§Œë“¤ê¸°

ìš°ë¦¬ì—ê²Œ ì£¼ì–´ì§„ ë°ì´í„°  $\mathrm{x} = \left[ x_1, x_2, \cdots, x_n\right]$ ê°€ ìˆì„ ë•Œ, ê°€ì¥ ë¨¼ì € í•´ì•¼ í•  ì¼ì€ ì´  $n$ê°œì˜ ë°ì´í„°ì…‹ì— ëŒ€í•´ ëª¨ë“  ë°ì´í„°í¬ì¸íŠ¸ ê°„ì˜ ìœ ì‚¬ë„ë¥¼ í‘œí˜„í•˜ëŠ”  $n \times n$  í–‰ë ¬ì„ ë§Œë“œëŠ” ê²ƒì…ë‹ˆë‹¤. ë‹¤ë¥¸ ë§ë¡œëŠ” ê° ë°ì´í„°ë¥¼ ë…¸ë“œë¡œ í•˜ëŠ” ìœ ì‚¬ë„ ê·¸ë˜í”„ë¥¼ ì°¾ì•„ì•¼ í•©ë‹ˆë‹¤. ì´ë•Œ ì´ ê·¸ë˜í”„ëŠ” ë‹¤ìŒê³¼ ê°™ì•˜ìœ¼ë©´ ì¢‹ê² ìŠµë‹ˆë‹¤.

- ì—°ê²°ëœ ë…¸ë“œ ìŒë§ˆë‹¤ ê°ì ì–¼ë§ˆë‚˜ ìœ ì‚¬í•œì§€ì— ë”°ë¼ ì—£ì§€ì— ê°€ì¤‘ì¹˜ê°€ ë¶€ì—¬ëœë‹¤. (Weighted)
- ê·¸ ê°€ì¤‘ì¹˜ëŠ” í•˜ë‚˜ì˜ ë…¸ë“œ ìŒì— ëŒ€í•´ í•˜ë‚˜ì˜ ê°’ìœ¼ë¡œ ì •í•´ì ¸ ìˆë‹¤. ì¦‰ $x_j$ â†’ $x_i$ ì™€  $x_i$ â†’ $x_j$ ê°€ ë‹¤ë¥´ì§€ ì•Šë‹¤. (Undirected)

ì´ ê·¸ë˜í”„ë¥¼ ë§Œë“¤ ë•ŒëŠ” $x_i$ê°€  $x_j$ì— ëŒ€í•´ ì–¼ë§Œí¼ í˜¹ì€ ëª‡ë²ˆì§¸ë¡œ ê°€ê¹Œì›Œì•¼ ë‘˜ì´ ì—°ê²°ë˜ì—ˆë‹¤ê³  ë´ ì¤„ ê²ƒì¸ì§€ì— ë”°ë¼ ì—¬ëŸ¬ ê°€ì§€ ì„ íƒì§€ê°€ ìˆìŠµë‹ˆë‹¤.

- $\varepsilon$-ì´ì›ƒ($\varepsilon$-neighbor) ê·¸ë˜í”„: ê±°ë¦¬ê°€ $\varepsilon$ë³´ë‹¤ ê°€ê¹Œìš´ ë…¸ë“œë§Œ ì—°ê²°í•˜ê³  ë‚˜ë¨¸ì§€ëŠ” ì—°ê²°í•˜ì§€ ì•ŠëŠ”ë‹¤.
- KNN(K-nearest Neighbor) ê·¸ë˜í”„: ê° ë…¸ë“œ ì£¼ë³€ì˜ ê°€ì¥ ê°€ê¹Œìš´ kê°œì˜ ì´ì›ƒë§Œ ì—°ê²°í•˜ê³  ë‚˜ë¨¸ì§€ëŠ” ì—°ê²°í•˜ì§€ ì•ŠëŠ”ë‹¤.
    - ë‹¨ ì´ ë°©ë²•ì„ ì‚¬ìš©í•  ë•Œ ì£¼ì˜í•´ì•¼ í•  ê²ƒì€ ìš°ë¦¬ê°€ ë°©í–¥ì´ ì—†ëŠ” ê·¸ë˜í”„ë¥¼ ì›í•œë‹¤ëŠ” ì . Aì—ê²ŒëŠ” Bê°€ nearestì¸ë° Bì—ê²ŒëŠ” Aê°€ nearestê°€ ì•„ë‹Œ ì´ìŠˆê°€ ìˆì„ ìˆ˜ ìˆë‹¤. ê·¸ë˜ì„œ ë‘˜ ë‹¤ í•´ë‹¹ì¼ ë•Œë§Œ ì—£ì§€ë¥¼ ìƒì„±í•˜ë“ ì§€ ë‘˜ì¤‘ í•˜ë‚˜ë¼ë„ ë˜ë©´ ë°©í–¥ ë¬´ì‹œí•˜ê³  ìƒì„±í•˜ë“ ì§€ í•˜ëŠ” ì‹ìœ¼ë¡œ ì‚´ì§ ì¡°ì •ì´ í•„ìš”í•˜ë‹¤.
- ì™„ì „ ì—°ê²° ê·¸ë˜í”„(Fully connected) ê·¸ë˜í”„: ëˆ„ë½ ì—†ì´ ëª¨ë“  ë…¸ë“œë¥¼ ì—°ê²°í•œë‹¤.

ì—°ê²°ë˜ì—ˆëŠ”ì§€ ì•„ë‹Œì§€ë¿ë§Œ ì•„ë‹ˆë¼ ì–¼ë§ˆë‚˜ ê°•í•˜ê²Œ(ê°€ê¹Œì´) ì—°ê²°ë˜ì–´ ìˆëŠ”ì§€ë„ ì¤‘ìš”í•©ë‹ˆë‹¤. ì´ í–‰ë ¬ì˜ ì›ì†Œ ê°’ì€ ë¬´ì¡°ê±´ 1 ë˜ëŠ” 0ì´ ì•„ë‹ˆë¼, ì—°ê²°ë˜ì§€ ì•Šì€ ì—£ì§€ì¼ ê²½ìš° 0, ì—°ê²°ëœ ì—£ì§€ì¼ ê²½ìš° **ê±°ë¦¬ê°€ ê°€ê¹Œìš¸ìˆ˜ë¡(=ìœ ì‚¬ë„ê°€ ë†’ì„ìˆ˜ë¡) í° ê°’ì„ ê°–ë„ë¡ í•˜ëŠ” ê°€ì¤‘ì¹˜**ë¥¼ ì„¤ì •í•©ë‹ˆë‹¤. ë³´í†µ ë‹¤ìŒê³¼ ê°™ì´ **ê°€ìš°ì‹œì•ˆ ì»¤ë„**ì„ ì´ìš©í•©ë‹ˆë‹¤. 

$$
 w_{ij} = \exp(-\frac{\Vert x_i -x_j \Vert^2}{ 2 \sigma^2})
$$

ì´ê±¸ ì¸ì ‘(Adjacency) í–‰ë ¬ì´ë¼ê³ ë„ í•©ë‹ˆë‹¤. ë˜ëŠ” ìœ ì‚¬ë„(Similartiy) í–‰ë ¬ì´ë¼ê³  ë¶€ë¥¼ ìˆ˜ë„ ìˆê² ë„¤ìš”. ëŒ€ì¹­ í–‰ë ¬ì´ê³ ìš”. ì—¬ê¸°ì„œëŠ” $A$ë‚˜  $S$ ë§ê³  ê·¸ëƒ¥  $W$ë¼ê³  í•˜ê² ìŠµë‹ˆë‹¤.

ì´  $W$ëŠ” ë‹¤ìŒê³¼ ê°™ì€ ì„±ì§ˆì„ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤.

- $w_{ij} \ge 0$   ($x_i$ ì™€ $x_j$ê°€ ë” ìœ ì‚¬í• ìˆ˜ë¡ í° ê°’ì´ ë¶€ì—¬ë˜ëŠ” ê°€ì¤‘ì¹˜)
- $w_{ii} = 0$   ($x_i$ ì™€ $x_i$ì— ëŒ€í•´ì„œëŠ” 0ìœ¼ë¡œ ì„¤ì •)
- $w_{ij} = w_{ji}$ *ë¬´ë°©í–¥ ê·¸ë˜í”„, ëŒ€ì¹­ í–‰ë ¬

ì´ì œ ìš°ë¦¬ëŠ” ì›ë˜ ë°ì´í„°ë¥¼ í´ëŸ¬ìŠ¤í„°ë¡œ ë‚˜ëˆ„ëŠ” ë¬¸ì œì—ì„œ ì£¼ì–´ì§„ ê·¸ë˜í”„ë¥¼ ì‘ì€ ê·¸ë˜í”„ë¡œ ë‚˜ëˆ„ëŠ” ë¬¸ì œë¡œ ë°”ê¾¸ì—ˆìŠµë‹ˆë‹¤. í´ëŸ¬ìŠ¤í„°ë§ì˜ ê¸°ë³¸ ëª©ì ì„ ê¸°ì–µí•´ ë´…ì‹œë‹¤.

- (ì›ë˜ ë¬¸ì œ) ì£¼ì–´ì§„ ë°ì´í„°í¬ì¸íŠ¸ë“¤ì„ í´ëŸ¬ìŠ¤í„°ë¡œ ë‚˜ëˆ„ë˜, ê°™ì€ í´ëŸ¬ìŠ¤í„° ë‚´ì—ì„œëŠ” ë°ì´í„°í¬ì¸íŠ¸ ê°„ ìœ ì‚¬ë„ê°€ ë†’ê³  ë‹¤ë¥¸ í´ëŸ¬ìŠ¤í„° ê°„ì—ì„œëŠ” ìœ ì‚¬ë„ê°€ ë‚®ê²Œ í•˜ì.
- (ìƒˆë¡œìš´ ë¬¸ì œ) ì£¼ì–´ì§„ ê·¸ë˜í”„ì˜ ë…¸ë“œë“¤ì„ í´ëŸ¬ìŠ¤í„°ë¡œ ë‚˜ëˆ„ë˜, ê°™ì€ í´ëŸ¬ìŠ¤í„° ë‚´ì—ì„œëŠ” ì—£ì§€ì˜ ê°€ì¤‘ì¹˜ í•©ì´ ë†’ê³  ë‹¤ë¥¸ í´ëŸ¬ìŠ¤í„° ê°„ì—ëŠ” ì—°ê²°í•˜ëŠ” ì—£ì§€ì˜ ê°€ì¤‘ì¹˜ í•©ì´ ë‚®ê²Œ í•˜ì.

ì´ì œ ìœ ì‚¬ë„ ê·¸ë˜í”„ë¥¼ 2ê°œ í˜¹ì€ ê·¸ ì´ìƒì˜ ê·¸ë˜í”„ë¡œ ìª¼ê°œë³´ê² ìŠµë‹ˆë‹¤. ê·¸ ì „ì— ëª‡ ê°€ì§€ ì²˜ìŒ ë³´ëŠ” ê°œë…ì´ í•„ìš”í•©ë‹ˆë‹¤. 

### ê·¸ë˜í”„ ìª¼ê°œê¸° ë¬¸ì œ ì •ì˜ - Cut?

ê·¸ë˜í”„ ë‚´ë¶€ì— ë…¸ë“œë“¤ì˜ ì§‘í•© A, B (Subgraph)ì´ ìˆì„ ë•Œ, Aì—ì„œ Bë¥¼ ì—°ê²°í•˜ëŠ” ì—£ì§€ë“¤ì˜ ê°€ì¤‘ì¹˜ì˜ í•©ì„ Cutì´ë¼ê³  ë¶€ë¥´ê¸°ë¡œ í•©ë‹ˆë‹¤.

$$
Cut(A,B) = \sum_{i \in A, j\in B} w_{ij} 
$$

ë¬¼ë¡  í•˜ë‚˜ì˜ ì§‘í•© ë‚´ë¶€ì—ì„œë„ ë˜‘ê°™ì´ ê³„ì‚°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. $Cut(A,A)$  ëŠ” A ë‚´ë¶€ ì—£ì§€ë“¤ì˜ ëª¨ë“  ê°€ì¤‘ì¹˜ì˜ í•©ì…ë‹ˆë‹¤.

ë§Œì•½ ìš°ë¦¬ê°€ ë°ì´í„°ë¥¼ 2ê°œì˜ êµ°ì§‘ìœ¼ë¡œ ì˜ ë‚˜ëˆ„ê³  ì‹¶ë‹¤ë©´, ë‚˜ëˆ ì§„ êµ°ì§‘ 2ê°œê°€ ì„œë¡œ ìµœëŒ€í•œ ë©€ë¦¬ ë–¨ì–´ì ¸ ìˆìœ¼ë©´ ë©ë‹ˆë‹¤. ì¦‰ ë‘ ê·¸ë£¹ì„ ì—°ê²°í•˜ëŠ” ì—£ì§€ë“¤ì˜ ê°€ì¤‘ì¹˜ í•©ì´ ì ìœ¼ë©´ ëœë‹¤ëŠ” ëœ»ì´ê³ , ì´ ë§ì€ $\text{cut}(A, A^c)$ ë¥¼ ìµœì†Œí™”í•˜ê³  ì‹¶ë‹¤ëŠ” ëœ»ì…ë‹ˆë‹¤. ì´ê²ƒì´ ë°”ë¡œ **Minimum cut**ì˜ ì•„ì´ë””ì–´ì…ë‹ˆë‹¤. 

ê³„ì‚°ì€ ì–´ë µì§€ ì•Šìœ¼ë‚˜, ì¢…ì¢… ì•„ë˜ì™€ ê°™ì€ ê²°ê³¼ê°€ ë‚˜ì˜¤ê³¤ í•©ë‹ˆë‹¤.

![](/assets/img/posts/2021-03-01-spectral-clustering_3.png)
_Minimum cutì˜ ì˜ëª»ëœ ì˜ˆ -  [ê·¸ë¦¼ ì¶œì²˜](https://snap.stanford.edu/class/cs224w-2019/slides/05-spectral.pdf)_

- íŒŒë€ì„ : êµ°ì§‘ì„ ë‚˜ëˆ„ëŠ” Cut
- ë¹¨ê°„ì„ : í˜¼ì ë™ë–¨ì–´ì§„ ë…¸ë“œì™€ ë‚˜ë¨¸ì§€ë“¤ì„ ë‚˜ëˆ„ëŠ” Cut â†’ Minimum cutì´ ë³´ê¸°ì—” ì–˜ê°€ ì œì¼ ë‚«ë‹¤! ì € í•˜ë‚˜ì˜ ì—£ì§€ë§Œ ê°€ì¤‘ì¹˜ê°€ ì ìœ¼ë©´ ë˜ë‹ˆê¹Œ.


> *ê·¼ë° ë‚˜ëŠ” ì•„ì›ƒë¼ì´ì–´ë¥¼ ì°¾ê³  ì‹¶ì€ ê²Œ ì•„ë‹ˆë¼ í´ëŸ¬ìŠ¤í„°ë¥¼ ì°¾ê³  ì‹¶ì€ ê±´ë°?* ğŸ¤” 
{: .prompt-danger} 

ê·¸ëŸ¬ë©´ $\text{Cut} (A, A^c)$  ëŠ” ì‘ê²Œ ìœ ì§€í•˜ë˜, **ë‚˜ëˆ ì§€ëŠ” 2ê°œ êµ°ì§‘ì˜ í¬ê¸°ë¥¼ ë¹„ìŠ·í•˜ê²Œ ìœ ì§€í•˜ë„ë¡** ì¡°ê±´ì„ ì¶”ê°€í•˜ë©´ ì–´ë–¨ê¹Œìš”?

ì—¬ê¸°ì„œ **RatioCut**ì´ ë“±ì¥í•©ë‹ˆë‹¤. 

$$
RatioCut(A) = Cut(A, A^c) \cdot (\frac{1}{\vert A \vert} +\frac{1}{\vert A^c \vert})
$$

ìœ„ ì‹ì˜ ë’·ë¶€ë¶„ì„ ë³´ë©´ ì „ì²´ ë…¸ë“œê°€  $n$ê°œë¼ê³  í•  ë•Œ, $\vert A \vert$ ë¡œ í‘œì‹œëœ ì§‘í•© $A$ì˜ í¬ê¸°(cardinality)ê°€  $\frac{n}{2}$ì— ê°€ê¹Œìš¸ìˆ˜ë¡ ì‘ì•„ì§„ë‹¤ëŠ” ê²Œ ë³´ì´ì‹¤ ê²ƒì…ë‹ˆë‹¤. ì¦‰ Cut ìì²´ë„ ì‘ì•„ì•¼ í•˜ì§€ë§Œ, $A$ì™€  $A^c$ê°€ ë¹„ìŠ·í•œ í¬ê¸°ë¥¼ ê°€ì ¸ì•¼ ì´ ê°’ì´ ì‘ì•„ì§‘ë‹ˆë‹¤.

ì´ì œ ìš°ë¦¬ê°€ í’€ì–´ì•¼ í•˜ëŠ” ë¬¸ì œëŠ” $\arg \min \text{RatioCut}$ ìœ¼ë¡œ ì •í–ˆìŠµë‹ˆë‹¤.

### ê·¸ë˜í”„ ìª¼ê°œê¸°  ë¬¸ì œ í’€ê¸° - ë¼í”Œë¼ì‹œì•ˆ í–‰ë ¬

ìŠ¬í”„ê²Œë„ ì´ ë¬¸ì œëŠ” NP-hardë¼ê³  í•©ë‹ˆë‹¤. (*ê¶ê¸ˆí•˜ì‹œë©´ [ì—¬ê¸°](https://suyeongpark.me/archives/1934)ë¥¼ ì‚´í´ë³´ì‹œê³ , ì•ˆ ê¶ê¸ˆí•˜ì‹œë‹¤ë©´ ê·¸ëƒ¥ í’€ê¸° ì–´ë µë‹¤ ì •ë„ë¡œ ìƒê°í•˜ì‹œê³  ë„˜ì–´ê°€ì…”ë„ ë©ë‹ˆë‹¤.)

ê·¸ë˜ì„œ ìš°ë¦¬ëŠ” ì´ê²ƒì„ ë‹¤ë¥¸ ë¬¸ì œë¡œ ë°”ê¿€ ê²ƒì…ë‹ˆë‹¤. ê·¸ëŸ¬ê¸° ìœ„í•´ì„œ ìš°ì„  **ë¼í”Œë¼ì‹œì•ˆ í–‰ë ¬(Laplacian matrix)**ë¥¼ ë§Œë“¤ ê²ë‹ˆë‹¤. ë§Œë“œëŠ” ë°©ë²•ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.

$$
L = D-W
$$

$W$ê°€ ì–´ë–¤ í–‰ë ¬ì¸ì§€ëŠ” ì•ì„œ ì„¤ëª…í–ˆì£ . ê·¸ëŸ¼ $D$ëŠ” ë­˜ê¹Œìš”?  $W$ë¡œë¶€í„° ë§Œë“¤ì–´ì§„ ëŒ€ê°í–‰ë ¬ì¸ë°, $D$ì˜ ëŒ€ê° ì›ì†Œë“¤ì€ ëª¨ë“  ë…¸ë“œë“¤ì— ëŒ€í•´ í•´ë‹¹ ë…¸ë“œì™€ ì—°ê²°ëœ ì—£ì§€ë“¤ì˜ ê°€ì¤‘ì¹˜ì˜ í•©ì„ ê³„ì‚°í•œ degreeì…ë‹ˆë‹¤. ë‚˜ë¨¸ì§€ ìë¦¬ë“¤ì€ 0ìœ¼ë¡œ ì±„ì›Œì¤ë‹ˆë‹¤.

- $d_i = \sum^n_{j=1} w_{ij}$
    
    $$
    D = \begin{bmatrix} d_1 & & & \\ & d_2  &  &   \\ & &\ddots \\ &&& d_n \end{bmatrix}
    $$
    

ì´ì œ ë¼í”Œë¼ì‹œì•ˆ í–‰ë ¬ $L$ì´ ë­”ì§€ëŠ” ì•Œì•˜ê³  ë§Œë“¤ ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤. 

ê·¸ ë‹¤ìŒ ê³¼ì •ì€ **ì•„ë˜ 3ê°€ì§€**ë¥¼ ìˆœì°¨ì ìœ¼ë¡œ ë”°ë¼ê°€ë©´ ë©ë‹ˆë‹¤. 

> ê·¸ ê³¼ì •ì—ì„œ ì œë²• ë§ì€ ì¦ëª…ì´ í•„ìš”í•©ë‹ˆë‹¤. ì´ ê¸€ì—ëŠ” ê²°ë¡  ìœ„ì£¼ë¡œ ê¸°ìˆ í•  ê²ƒì¸ë°ìš”, ì œê°€ ì£¼ë¡œ ì°¸ê³ í•œ [ëª¨ë“  ì‹ì˜ ì¦ëª…ì´ ì •ë§ ì˜ ì •ë¦¬ëœ í˜ì´ì§€](https://gjkoplik.github.io/spectral_clustering/#proofs_with_2_clusters)ê°€ ìˆìŠµë‹ˆë‹¤. ì•„ë˜ ë¶€ë¶„ ì½ë‹¤ê°€ ì´ ì‹ì´ ëŒ€ì²´ ì™œ? ë¼ëŠ” ìƒê°ì´ ë“œì‹ ë‹¤ë©´ í•œë²ˆì¯¤ ë°©ë¬¸í•´ ë³´ì‹œê¸¸ ì¶”ì²œí•´ ë“œë¦½ë‹ˆë‹¤. ê·¸ë¦¬ê³  **ê³ ìœ ë²¡í„°ì™€ ê³ ìœ ê°’ì˜ ê°œë…** ì •ë„ëŠ” í•„ìš”í•©ë‹ˆë‹¤. ê·¸ê±´ ì € í˜ì´ì§€ì— ê°€ì…”ë„ ì„¤ëª…ì´ ì—†ìœ¼ë‹ˆ ğŸ“ [ì—¬ê¸°](https://angeloyeo.github.io/2019/07/17/eigen_vector.html)ë¥¼ í•œë²ˆ ì°ê³  ì™€ì£¼ì„¸ìš”!
{: .prompt-warning}

1. **ìš°ë¦¬ê°€ í’€ê³  ì‹¶ì€ ë¬¸ì œë¥¼ ì–´ë–»ê²Œ $L$ì´ ë“¤ì–´ê°„ ë¬¸ì œë¡œ ë°”ê¿€ê¹Œ?**
    - ê·¸ë˜í”„ì˜ ê° ë…¸ë“œë“¤ì„ ì‹¤ìˆ˜ë¡œ ë°”ê¿”ì£¼ëŠ” ë§µí•‘ $f$ê°€ ìˆë‹¤ê³  í•˜ì.
        
        $$
        f = \begin{bmatrix} f (\mathbb{v_1} ) \\ f (\mathbb{v_2}) \\ \cdots \\ f (\mathbb{v_n}) \end{bmatrix} = \begin{bmatrix} f_1 \\ f_2 \\ \cdots \\ f_3 \end{bmatrix}
        $$
        
    - ê° ë…¸ë“œì— ëŒ€í•´
        
        $$
         f_A(i) = \begin{cases} \sqrt{\frac{\vert A^c \vert}{\vert A \vert}} & \mathbb{v}_i \in A \\ - \sqrt{\frac{\vert A \vert}{\vert A^c \vert}} & \mathbb{v}_i \in A^c  \end{cases}
        $$
        
    - ê·¸ë¦¬ê³  indicator í•¨ìˆ˜ë„ ë‹¤ìŒê³¼ ê°™ì´ ì •ì˜í•œë‹¤.
        
        $$
        \mathbf{1}_A(i) = \begin{cases} 1 & v_i \in A \\ 0 & v_i \in A^c\end{cases}
        $$
        
    - $f^TLf = \frac{1}{2} \sum_{ij} w_{ij} (f_i-f_j)^2$ ì´ê³ , $\text{RatioCut}(A) = n \cdot f_A^T L f_A$  (*ì¦ëª… í•„ìš”)
    - ì¦‰ $\arg \min \text{RatioCut}(A) = \arg \min  \text f_A^T Lf_A$
        - ì´ë•Œ $f_A \cdot \mathbb{1}_V = 0$
    - NP-hardì´ë¯€ë¡œ $\arg \min  \text f^T Lf$  ë¡œ relaxí•œë‹¤! ì´ì œ $f$ë§Œ êµ¬í•˜ë©´ ëœë‹¤.
2. **ì™œ  $L$ì˜ 2ë²ˆì§¸ë¡œ ì‘ì€ ê³ ìœ ê°’ì— ëŒ€ì‘í•˜ëŠ” ê³ ìœ ë²¡í„°ê°€ ê·¸ ë¬¸ì œì˜ ë‹µì¼ê¹Œ?**
    - Rayleigh-Ritz Theoremì´ë¼ëŠ” ì •ë¦¬ê°€ ìˆë‹¤. ë‚´ìš©ì€ ê°„ë‹¨í•˜ê²Œ,
        - Raleigh Quotient  $R(\mathrm{x}) = \frac{\Vert A \mathrm{x} \Vert ^2}{\Vert \mathrm{x} \Vert} = \frac{\mathrm{x}^T S \mathrm{x}}{\mathrm{x}^T\mathrm{x}}$ ê°€ ìˆë‹¤ ($\mathrm{x}$ëŠ” ë²¡í„°, $S$ëŠ” ì–´ë–¤ í–‰ë ¬ $A$ì— ëŒ€í•´  $S=A^TA$ ëŒ€ì¹­í–‰ë ¬).
        - $S$ì˜ ê³ ìœ ê°’  $\lambda_1 \le \lambda_2 \le \cdots \le \lambda _n$ì— ê³¼ ê°ê° ëŒ€ì‘í•˜ëŠ” ê³ ìœ ë²¡í„°  $\mathrm{v_1}, \mathrm{v_2}, \cdots, \mathrm{v_n}$ê°€ ìˆë‹¤.
        - $R(\mathrm{x})$ì˜ ìµœëŒ€ê°’ì€ $\mathrm{x} = \mathrm{v_n}$ ì¼ ë•Œ  $\lambda_n$ì´ê³  (ê°€ì¥ í° ê³ ìœ ê°’), **ìµœì†Œê°’ì€ $\mathrm{x} = \mathrm{v}_1$ ì¼ ë•Œ $\lambda_1$ì´ê³   (ê°€ì¥ ì‘ì€ ê³ ìœ ê°’)**
        - [ì°¸ê³ ](https://blog.naver.com/PostView.nhn?blogId=skkong89&logNo=221853464760&categoryNo=47&parentCategoryNo=0&viewDate=&currentPage=1&postListTopCurrentPage=1&from=postView)
    - ìœ„ ì •ë¦¬ë¥¼ ì´ìš©í•˜ì—¬ $L$ì˜ ì²«ë²ˆì§¸ë¡œ 0ì´ ì•„ë‹Œ ê°€ì¥ ì‘ì€ ê³ ìœ ê°’(Fiedler valueë¼ê³ ë„ ë¶€ë¥¸ë‹¤)ì— í•´ë‹¹í•˜ëŠ” ë‘ë²ˆì§¸ ê³ ìœ ë²¡í„°ê°€ ìš°ë¦¬ê°€ ì°¾ëŠ” ë‹µì´ë‹¤.
        - (ì°¸ê³ ë¡œ ê°€ì¥ ì‘ì€ ê³ ìœ ê°’ì€ 0ì´ê³  ì´ì— ëŒ€ì‘í•˜ëŠ” ê³ ìœ ë²¡í„°ëŠ” 1ì´ë‹¤.)
3. **ê³ ìœ ë²¡í„° êµ¬í–ˆë‹¤. ì´ê±¸ë¡œ ë­˜ í•˜ë¼ê³ ?**
    - ì¦‰ ì´ì œ í•´ë‹¹ ê³ ìœ ë²¡í„°ë¥¼ êµ¬í•´ì„œ $f$ë¡œ ì“°ëŠ”ë°,
    - ì• ì´ˆì— $f$ë¥¼ ì–´ë–»ê²Œ ì •ì˜í–ˆëŠ”ì§€ ìƒê°í•´ë³´ë©´, $f_A$ëŠ” ê° ë…¸ë“œê°€ $A$ì— ì†í•˜ë©´ $fâ‰¥0$ ì´ê³  ì†í•˜ì§€ ì•Šìœ¼ë©´ $f<0$ì´ë„ë¡ ë§µí•‘í–ˆë‹¤.
    - ë”°ë¼ì„œ ê° ë°ì´í„°í¬ì¸íŠ¸ë“¤ì— ëŒ€í•´ $f$ ê°’ì´ ìŒìˆ˜ì¸ì§€ ì–‘ìˆ˜ì¸ì§€ì— ë”°ë¼ êµ°ì§‘ì„ êµ¬ë¶„í•  ìˆ˜ ìˆê³ , ë³´ë‹¤ ì•ˆì „í•˜ê²Œ $k=2$ì¸ K-Means ì•Œê³ ë¦¬ì¦˜ì„ ì ìš©í•œë‹¤ë©´ 2ê°œì˜ í´ëŸ¬ìŠ¤í„°ë¡œ ì˜ ìª¼ê°œì§ˆ ê²ƒì´ë‹¤!
        - í´ëŸ¬ìŠ¤í„°ë¥¼ ì–»ì—ˆë‹¤. ğŸ‘

### 2ê°œ ë§ê³  kê°œì˜ êµ°ì§‘ì„ ì°¾ê³  ì‹¶ë‹¤ë©´ - ì¼ë°˜í™”

ì—¬ëŸ¬ ê°œì˜ í´ëŸ¬ìŠ¤í„°ë¥¼ ì°¾ëŠ” ê²½ìš°ë¼ë©´? 2ê°œë¡œ ìª¼ê°  ë‹¤ìŒ ë˜ ê°ê°ì„ 2ê°œë¡œ ë‚˜ëˆ„ëŠ” ì‹ìœ¼ë¡œ bi-partitioningì„ ë°˜ë³µí•´ë„ ë©ë‹ˆë‹¤. í•˜ì§€ë§Œ ë¹„íš¨ìœ¨ì ì´ê³  ë¶ˆì•ˆì •í•œ(ì •ë³´ ì†ì‹¤ì´ ë°œìƒí•˜ëŠ”) ë°©ë²•ì…ë‹ˆë‹¤. ì²˜ìŒë¶€í„° í•œë²ˆì— ì—¬ëŸ¬ ê°œì˜ í´ëŸ¬ìŠ¤í„°ë¥¼ ì°¾ê³  ì‹¶ì–´ìš”. ê·¸ëŸ¬ë©´ ê°„ë‹¨íˆ ë§í•˜ë©´, **ê³ ìœ ë²¡í„°ë¥¼ ì—¬ëŸ¬ ê°œë¥¼ ì“°ë©´ ë©ë‹ˆë‹¤**.

ìƒì„¸íˆ ì²˜ìŒë¶€í„° ì‚´í´ë³´ë©´ ë¬¸ì œëŠ” ë‹¤ì‹œ ì´ë ‡ê²Œ ì •ì˜ë©ë‹ˆë‹¤.

$$
RatioCut(A_1, \cdots, A_k) = \sum^k_{i=1} \frac{Cut (A_i)}{\vert A_i \vert}
$$

ê·¸ëŸ¬ë‹ˆê¹Œ ì „ì²´ ê·¸ë˜í”„ë¥¼ $A_1$ë¶€í„° $A_k$ë¡œ ë‚˜ëˆ„ê³  ì‹¶ì€ ê²ƒì´ì£ . ê³¼ì •ì€ ë¹„ìŠ·í•©ë‹ˆë‹¤.

- ë‹¤ìŒê³¼ ê°™ì´ indicator ë²¡í„°ë¥¼ ì •ì˜í•œë‹¤.

$$
(h_l)_i = \begin{cases}\frac{1}{\sqrt{\vert A_{\mathcal{l}}\vert}} & v_i \in A_{l} \\ 0 & v_i \notin A_l \end{cases}
$$

- $(H^TH) = I_n$ ì¸ orthogonal í–‰ë ¬  $H$

$$
H = \begin{bmatrix} \vert & \vert & & \vert \\h_1 & h_2 & \cdots & h_k \\ \vert & \vert & & \vert \end{bmatrix}
$$

- 2ê°€ì§€ë¥¼ ë¨¼ì € ì¦ëª…
    - $\frac{\text{Cut}(A)}{\vert A_l \vert} = \frac{1}{2}\sum w_{ij} (\frac{1}{\sqrt{\vert A_l \vert}})^2 +$ $\frac{1}{2}\sum w_{ij} (-\frac{1}{\sqrt{\vert A_l \vert}})^2$  = $h_l^T Lh_l$
    - $(H^TLH)_{ll} = h_l^TLh_l$
- $\text{RatioCut}(A_1, \cdots, A_k) = \sum^k _{l=1} h_l^TLh_l = \sum^k _{l=1}  (H^TLH)_{ll} = \text{Tr}(H^TLH)$
    - Tr: Trace!
- ì¦‰ ìš°ë¦¬ê°€ í’€ì–´ì•¼ í•˜ëŠ” ë¬¸ì œë¥¼ $\arg \min \text{Tr} (H^TLH)$ ë¡œ ë°”ê¾¸ì—ˆê³ 
    - ë™ì¼í•˜ê²Œ Rayleigh-Ritz ì •ë¦¬ë¥¼ í™•ì¥í•˜ì—¬ ì´ Trace ê°’ì„ ìµœì†Œí™”í•˜ëŠ” í–‰ë ¬ $H$ëŠ” $L$ì˜ ê°€ì¥ ì‘ì€ $k$ê°œì˜ ê³ ìœ ê°’ì— ëŒ€ì‘í•˜ëŠ” $k$ê°œì˜ ë²¡í„°ë¥¼ ë¶™ì—¬ ë§Œë“  í–‰ë ¬ì„ì„ ì•Œ ìˆ˜ ìˆë‹¤.
- ë‚˜ë¨¸ì§€ ë‹¨ê³„ëŠ” 2ê°œ í•  ë•Œë‘ ë¹„ìŠ·í•˜ê²Œ, $h$ë¥¼ ê° ë…¸ë“œê°€ $A_i$ì— ì†í•˜ë©´ ì–‘ìˆ˜ì˜ ê°’ì„, ë‹¤ë¥¸ ë…¸ë“œì—ëŠ” 0ì„ ë§µí•‘í•˜ë„ë¡ ì •ì˜í–ˆë‹¤ëŠ” ê²ƒì„ ê¸°ì–µí•˜ì. ë‹¤ë¥¸ $h$ë“¤ì€ ì´ ë…¸ë“œì— 0ì„ ì£¼ì—ˆë‹¤.
    - ì¦‰ $k$ê°œ ì°¨ì› ì¤‘ í•˜ë‚˜ì—ì„œë§Œ ì–‘ìˆ˜ë¥¼ ê°€ì§€ê³  ë‚˜ë¨¸ì§€ëŠ” ë‹¤ 0ìœ¼ë¡œ ê°ì í´ëŸ¬ìŠ¤í„°ë§ˆë‹¤ ë§µí•‘ì´ ë˜ì—ˆì„ ê²ƒì´ê³ , ê° í–‰ë§ˆë‹¤ í•˜ë‚˜ì˜ ì–‘ìˆ˜ê°’ë§Œ ìˆì–´ì•¼ í•œë‹¤.
    - ê·¸ëŸ¬ë©´ $\mathbb{R}^k$ ì˜ ìƒˆë¡œìš´ ë°ì´í„°í¬ì¸íŠ¸ë“¤ì—ì„œ  $k$ê°œ í´ëŸ¬ìŠ¤í„°ë¥¼ ì–»ì„ ìˆ˜ ìˆê³  ì—­ì‹œ k-meansë¥¼ ì“°ë©´ í´ëŸ¬ìŠ¤í„°ê°€ ìª¼ê°œì§ˆ ê²ƒì´ë‹¤!


![](/assets/img/posts/2021-03-01-spectral-clustering_4.png)
_$k=3$ ë¼ë©´ ëŒ€ì¶© ê³ ìœ  ë²¡í„°ë“¤ì´ ì´ëŸ° ëª¨ì–‘ì¼ ê²ƒ! [ê·¸ë¦¼ ì¶œì²˜](https://www.slideshare.net/JeonghunYoon/08-spectal-clustering)_

ì§€ê¸ˆê¹Œì§€ì˜ ê³¼ì •ì„ ì¡°ê¸ˆ ë‹¤ë¥´ê²Œ ì´í•´í•´ ë³¸ë‹¤ë©´, ìš°ë¦¬ê°€ ê°€ì§„ **ì›ë˜ì˜ ë°ì´í„°ë¥¼ ìƒˆë¡œìš´ ë” ë‚®ì€ ì°¨ì›ì˜ ë°ì´í„°ë¡œ ì‚¬ì˜í•œ í›„ ê·¸ ë°ì´í„°ë¥¼ ê°€ì§€ê³  í´ëŸ¬ìŠ¤í„°ë§ì„ í•˜ëŠ” ê²ƒê³¼ ë™ì¼**í•˜ë‹¤ê³  ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. PCAë¥¼ ì•„ì‹œëŠ” ë¶„ì´ë¼ë©´ PCAì—ì„œ ì£¼ì„±ë¶„ ë½‘ì•„ë‚´ëŠ” ê²ƒì´ë¼ê³  ìƒê°í•˜ë©´ ì´í•´ê°€ ë˜ì‹¤ ê±°ì˜ˆìš”.

ì˜ˆì»¨ëŒ€ 2ê°œ êµ°ì§‘ìœ¼ë¡œ ë‚˜ëˆ„ëŠ” ë¬¸ì œì—ì„œ ìš°ë¦¬ê°€ ìµœì¢…ì ìœ¼ë¡œ ì–»ì€ ê³ ìœ ë²¡í„°ë¥¼  $v$ ë¼ê³  í•˜ë©´, ì´ëŠ” ì›ë˜ì˜ ë°ì´í„°  $x$ ì— ëŒ€ì‘í•˜ëŠ” ìƒˆë¡œìš´ ë°ì´í„°í¬ì¸íŠ¸ë“¤ë¡œ ë³´ë©´ ë©ë‹ˆë‹¤. ì¦‰ $x_1$ ì´ $v_1$ ì´ê³ , $x_n$ ì´ $v_n$ (ê° ë°ì´í„°í¬ì¸íŠ¸)ì¸ ê²ƒì´ì£ .

$$
v = \begin{pmatrix} v_1 \\ v_2 \\ \cdots \\ v_n \end{pmatrix}
$$

ê³ ìœ ë²¡í„°ë¥¼ kê°œ ê³¨ëë‹¤ë©´? ì›ë˜ $n \times n$ì´ì—ˆë˜ ë°ì´í„°ëŠ”  $n \times k$ ê°œë¡œ ì°¨ì›ì´ ê°ì†Œí•˜ê²Œ ë©ë‹ˆë‹¤. ì¦‰ ì•„ë˜ í–‰ë ¬ì—ì„œ ê° í–‰ì´ ìƒˆë¡œìš´ $x_1$, $x_2$, $x_3$, $\cdots$ ì¸ ê²ƒì…ë‹ˆë‹¤(ê³ ìœ ê°’ì´ ì‘ì€ ìˆœì„œëŒ€ë¡œ).

$$
V = [\mathbf{v_1}, \mathbf{v_2}, \cdots, \mathbf{v_k}] = \begin{bmatrix} v_{11} & v_{12} & \cdots & v_{1k} \\ v_{21} & v_{22} & \cdots & v_{2k}  \\ \cdots \\ v_{n1} & v_{n2} & \cdots & v_{nk}  \end{bmatrix}
$$

ì´ì œ ì´ ìƒˆë¡œìš´ ë°ì´í„°í¬ì¸íŠ¸ë“¤ì„ k-means ì•Œê³ ë¦¬ì¦˜ì„ ì‚¬ìš©í•˜ì—¬ Kê°œì˜ í´ëŸ¬ìŠ¤í„°ë¡œ ë¶„í• í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤.

## ì£¼ìš” ë‚´ìš©ì€ ì•„ë‹ˆì§€ë§Œ ë” ê¶ê¸ˆí–ˆë˜ ê²ƒë“¤

### 1. $k$ë¥¼ ì„ íƒí•˜ëŠ” ë°©ë²•

 [ì´ í˜ì´í¼](https://arxiv.org/pdf/0711.0189.pdf)ì—ì„œëŠ” **Eigengap**ì„ í†µí•´ kë¥¼ ì„ íƒí•˜ëŠ” ë°©ë²•ì„ ì„¤ëª…í•´ì£¼ê³  ìˆìŠµë‹ˆë‹¤.

- Eigengap : $\vert \lambda_n - \lambda_{n+1} \vert$   (í¬ê¸°ìˆœìœ¼ë¡œ ëŠ˜ì–´ë†“ì•˜ì„ ë•Œ  $*n*$ë²ˆì§¸ ê³ ìœ ê°’ê³¼  $n+1$ ë²ˆì§¸ ê³ ìœ ê°’ì˜ ì°¨ì´)
- ì‰½ê²Œ ë§í•˜ë©´ $n$ê¹Œì§€ ê³ ìœ ê°’ì´ ë¹„ìŠ·í•˜ê²Œ ì‘ë‹¤ê°€ $n+1$ì—ì„œ ê°‘ìê¸° ì»¤ì§€ëŠ” ê³„ë‹¨ ëª¨ì–‘ì´ ëª‡ ë²ˆ ë‚˜íƒ€ë‚˜ëŠëƒ? ë¥¼ ì°¾ìëŠ” ê²ƒ.
- ë°ì´í„°ê°€ í™•ì‹¤íˆ ë¶„ë¦¬ë˜ì–´ ìˆì„ìˆ˜ë¡(í´ëŸ¬ìŠ¤í„°ê°€ ëšœë ·í• ìˆ˜ë¡) ê³ ìœ ê°’ì´ ê°‘ìê¸° ì»¤ì§€ëŠ” ê±¸ ë³¼ ìˆ˜ ìˆë‹¤.
![](/assets/img/posts/2021-03-01-spectral-clustering_5.png)

### 2. Unnormalized Cut? Normalized Cut?

ìœ„ì—ì„œ ë‹¤ë£¬ RatioCutì€ ì‚¬ì‹¤ Unnormalized Cutì…ë‹ˆë‹¤.

**Normalized Cut**ì€ ìµœì†Œí™”í•˜ê³ ì í•˜ëŠ” ì»·ì„ ì–´ë–»ê²Œ ì •ì˜í•˜ëŠëƒê°€ ë‹¤ë¦…ë‹ˆë‹¤.

$$
NormalizedCut(A) = Cut(A, A^c) \cdot (\frac{1}{Vol (A)} +\frac{1}{Vol (A^c)})
$$

$\text{Vol}(A)$ ëŠ” $A$ì— ì†í•œ ëª¨ë“  ë…¸ë“œì— ì—°ê²°ëœ ëª¨ë“  ê°€ì¤‘ì¹˜ì˜ í•©ìœ¼ë¡œ ì •ì˜í•©ë‹ˆë‹¤. ì¦‰,   $\text{Cut}(A,A)$ ì—  $\text{Cut}(A,B)$ë¥¼ ë”í•´ì¤€ ê°’ì…ë‹ˆë‹¤.

ì´ê²Œ RatioCutì— ë¹„í•´ ì–´ë–¤ ì¥ì ì„ ì§€ë‹ê¹Œìš”?  $\text{Vol}(A)$ì™€  $\text{Vol}(A^c)$ê°€ ë¹„ìŠ·í•˜ê³ , ë™ì‹œì— ê° êµ°ì§‘ ë‚´ë¶€ ë³¼ë¥¨ì´ ì»¤ì§ˆìˆ˜ë¡ NormalizedCutì€ ì‘ì•„ì§‘ë‹ˆë‹¤. êµ°ì§‘ ë‚´ë¶€ ë³¼ë¥¨ì´ í¬ë‹¤ëŠ” ê²ƒì€ **êµ°ì§‘ ë‚´ë¶€ ë…¸ë“œë“¤ì´ ì„œë¡œ ìœ ì‚¬ë„ê°€ í¬ë‹¤**ëŠ” ëœ»ì…ë‹ˆë‹¤.

ë‹¤ì‹œ í´ëŸ¬ìŠ¤í„°ë§ì˜ ê¸°ë³¸ ëª©ì ì„ ìƒê°í•´ ë´…ì‹œë‹¤.

1. êµ°ì§‘ ê°„ ìœ ì‚¬ë„ë¥¼ ìµœì†Œí™”í•˜ëŠ” ê²ƒ (between-cluster similarity) â†’  $\text{Cut}(A, A^c)$ ì„ ì¤„ì¸ë‹¤.
2. êµ°ì§‘ ë‚´ ìœ ì‚¬ë„ë¥¼ ìµœëŒ€í™”í•˜ëŠ” ê²ƒ  (within-cluster similarity) â†’ $\text{Cut}(A, A)$ ì™€ $\text{Cut}(A^c, A^c)$ ( *$A$ì™€ $A^c$ ê°ê°ì˜ ë‚´ë¶€ ìœ ì‚¬ë„)ë¥¼ ëŠ˜ë¦°ë‹¤.

ì¦‰ RatioCutì˜ ê²½ìš°ëŠ” êµ°ì§‘ ê°„ ìœ ì‚¬ë„ ìµœì†Œí™”ë¼ëŠ” ëª©ì ì€ ì¶©ì¡±í•˜ì§€ë§Œ êµ°ì§‘ ë‚´ ìœ ì‚¬ë„ ìµœëŒ€í™”ëŠ” ì¶©ì¡±í•˜ì§€ ëª»í•©ë‹ˆë‹¤. ë°˜ë©´ NormalizedCutì€ ë‘ ê°œ ëª©ì  ëª¨ë‘ë¥¼ ì¶©ì¡±í•˜ë„ë¡ ì„¤ì •ëœ ë¬¸ì œì…ë‹ˆë‹¤. í’€ì–´ì„œ ì¨ë³´ë©´, 

$\text{Cut}(A,A) = \text{Vol}(A) - \text{Cut}(A,A^c)$

ì´ê±¸ ìµœëŒ€í™”í•˜ë ¤ë©´ $\text{Vol}(A)$ëŠ” í¬ê³  $\text{Cut}(A, A^c)$ëŠ” ì‘ì•„ì•¼ í•©ë‹ˆë‹¤. NormalizedCut ì‹ê³¼ ë˜‘ê°™ì£ .

RatioCut ê°™ì€ ê²½ìš°ì—ëŠ” ë¼í”Œë¼ì‹œì•ˆ í–‰ë ¬ì„  $L = D - W$ë¡œ ì¼ì—ˆìŠµë‹ˆë‹¤. NormalizedCutì€ ë‹¤ìŒ 2ê°œ ì¤‘ í•˜ë‚˜ë¥¼ ì”ë‹ˆë‹¤. ë‹¤ë¥¸ ë¶€ë¶„ë“¤(ì´ ë¼í”Œë¼ì‹œì•ˆ í–‰ë ¬ì˜ $k$ê°œ ê³ ìœ ë²¡í„°ë¥¼ ì„ íƒí•˜ëŠ” ë¶€ë¶„)ì€ ë¹„ìŠ·í•©ë‹ˆë‹¤. 

- $L_{sym} = D^{-\frac{1}{2}}LD^{-\frac{1}{2}} = I - D^{-\frac{1}{2}}WD^{-\frac{1}{2}}$
- $L_{rw} = D^{-1}L = I-D^{-1}W$

ê·¸ë˜í”„ê°€ normalí•˜ê³ , ëŒ€ë¶€ë¶„ì˜ ë…¸ë“œê°€ ëŒ€ëµ ê°™ì€ degreeë¥¼ ê°€ì§€ëŠ” ê²½ìš° $L, L_{sym}, L_{rw}$ ì„¸ ê°œì˜ ë°©ë²•ì´ ê±°ì˜ ë™ì¼í•œ í´ëŸ¬ìŠ¤í„°ë§ ê²°ê³¼ë¥¼ ë„ì¶œí•˜ì§€ë§Œ, degreeê°€ ë„“ê²Œ í¼ì§„ ë¶„í¬ì¼ ê²½ìš° normalizedëœ ë°©ë²•ì´ ë‚«ê³ , $L_{rw}$ ê°€ ë” ì¢‹ë‹¤ê³  í•˜ë„¤ìš”.

## ì°¸ê³ í•œ ê¸€ë“¤

- [https://arxiv.org/pdf/0711.0189.pdf](https://arxiv.org/pdf/0711.0189.pdf)
- [https://gjkoplik.github.io/spectral_clustering/#proofs_with_2_clusters](https://gjkoplik.github.io/spectral_clustering/#proofs_with_2_clusters)
- [https://www.slideshare.net/JeonghunYoon/08-spectal-clustering](https://www.slideshare.net/JeonghunYoon/08-spectal-clustering)
- [https://ratsgo.github.io/machine learning/2017/04/27/spectral/](https://ratsgo.github.io/machine%20learning/2017/04/27/spectral/)
- [https://snap.stanford.edu/class/cs224w-2019/slides/05-spectral.pdf](https://snap.stanford.edu/class/cs224w-2019/slides/05-spectral.pdf)


